(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{110:function(e,t){},165:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(12),l=n.n(r),i=(n(80),n(4)),c=n(73),s=n(5),m=n(70),d=n.n(m),u=n(169),f=n(1),g=n(47),h=n(44),p=n(21),y=n(168),v={tl:{r:0,c:0},tr:{r:0,c:22},bl:{r:18,c:0},br:{r:18,c:22}},w={boardDims:{w:23,h:19},boardCorners:v,initialPlayerPos:[v.tl,v.tr],goals:[v.br,v.bl],playerColors:["red","indigo"],groundSize:37,wallWidth:12,smallScreenGroundSize:23,smallScreenWallWidth:10},b=n(32),k=n(29),E=n.n(k),C=n(30),S=n.n(C),x=function(e,t){t&&0!==t||(t=2500),Object(p.c)(e,{autoClose:t,hideProgressBar:!0,transition:p.a,pauseOnFocusLoss:!1})},T=n(15),O=n.n(T);function R(e){return e.r%2===0&&e.c%2===0?"Ground":e.r%2===0&&e.c%2===1||e.r%2===1&&e.c%2===0?"Wall":"Pillar"}function j(e,t){return e.r===t.r&&e.c===t.c}function N(e){for(var t=[],n=0;n<e.h;n++){t[n]=[];for(var a=0;a<e.w;a++)t[n][a]=0}return t}function P(e,t){return e.r>=0&&e.r<t.h&&e.c>=0&&e.c<t.w}function D(e,t){return"Wall"===R(t)&&0!==e[t.r][t.c]}function I(e,t){var n=function(e){return{h:e.length,w:e[0].length}}(e);if("Ground"!==R(t))return[];for(var a=[{r:0,c:1},{r:0,c:-1},{r:1,c:0},{r:-1,c:0}],o=[],r=[t.r,t.c],l=r[0],i=r[1],c=0;c<a.length;c++){var s=[a[c].r,a[c].c],m=s[0],d=s[1],u={r:l+m,c:i+d},f={r:l+2*m,c:i+2*d};P(f,n)&&!D(e,u)&&o.push(f)}return o}function G(e,t,n){if(j(t,n))return 0;var a=e[0].length,o=function(e){return e.r*a+e.c},r=[],l=0;r.push(t);var i=new Map;for(i.set(o(t),0);l<r.length;){var c=r[l];l+=1;for(var s=I(e,c),m=0;m<s.length;m++){var d=s[m];if(!i.has(o(d))){if(i.set(o(d),i.get(o(c))+1),j(d,n))return i.get(o(d));r.push(d)}}}return-1}function W(e,t,n,a){if(j(t,n))return 0;var o=e[0].length,r=function(e){return e.r*o+e.c},l=[],i=0;l.push(t);var c=new Map;for(c.set(r(t),0);i<l.length;){var s=l[i];i+=1;var m=c.get(r(s));if(m>a)return!1;for(var d=I(e,s),u=0;u<d.length;u++){var f=d[u];if(!c.has(r(f))){if(j(f,n))return m+1<=a;c.set(r(f),m+1),l.push(f)}}}return!1}function L(e,t,n){return-1!==G(e,t,n)}function A(e,t,n,a){if(D(e,a))return!1;e[a.r][a.c]=1;var o=function(e,t,n){for(var a=0;a<t.length;a++)if(!L(e,t[a],n[a]))return!1;return!0}(e,t,n);return e[a.r][a.c]=0,o}var M=w.goals,H=w.boardDims,z=w.initialPlayerPos,B=function(e){return e.moveHistory.length-1},_=function(e){return B(e)%2===(e.creatorStarts?0:1)},F=function(e){return _(e)?0:1},V=function(e){return null===e?"None":R(e)},q=function(e){return e.arePlayersPresent["Creator"===e.clientRole?1:0]},J=function(e,t,n,a,o,r,l){for(var i=O()(e),c=0;c<l.length;c++){var s=l[c];i[s.r][s.c]=1}return"Ground"===R(t)?G(i,n,t):A(i,[n,a],[o,r],t)?1:0},U=function(e,t){if(t&&(t.isVolumeOn&&"true"===t.isVolumeOn&&(e.isVolumeOn=!0),t.zoomLevel)){var n=parseInt(t.zoomLevel);n>=0&&n<=10&&(e.zoomLevel=n)}},Y=function(e,t,n,a){e.clientRole="Creator",e.lifeCycleStage=-1,e.timeControl=t,e.names[0]=n,e.tokens[0]=a;var o=60*t.duration;e.moveHistory[0].timeLeft=[o,o]},K=function(e,t,n,a){e.clientRole="Joiner",e.lifeCycleStage=-1,e.joinCode=t,e.names[1]=n,e.tokens[1]=a},Q=function(e,t,n){0!==e.lifeCycleStage&&(e.joinCode=t,e.creatorStarts=n,e.lifeCycleStage=0)},X=function(e,t,n,a,o,r){if(1!==e.lifeCycleStage){e.creatorStarts=o,e.names[0]=t,e.tokens[0]=n,e.timeControl=a,e.arePlayersPresent[0]=r;var l=60*a.duration;e.moveHistory[0].timeLeft=[l,l],e.lifeCycleStage=1}},Z=function(e,t,n){1!==e.lifeCycleStage&&(e.names[1]=t,e.tokens[1]=n,e.lifeCycleStage=1)},$=function(e,t,n,a){if(!(e.lifeCycleStage<1||e.lifeCycleStage>3)){var o=B(e);if(o===a-1){var r=F(e),l=0===r?1:0,i=O()(e.moveHistory[o].playerPos),c=O()(e.moveHistory[o].grid),s=O()(e.moveHistory[o].timeLeft),m=O()(e.moveHistory[o].wallCounts);s[r]=n;for(var d=0;d<t.length;d++){var u=t[d],f=R(u);if("Ground"===f){if(i[r]=u,j(u,M[r])){var g=o%2===0,h=W(c,i[l],M[l],2);g&&h?(e.winner="draw",e.gameWins[0]+=.5,e.gameWins[1]+=.5):(e.winner=0===r?"creator":"joiner",e.gameWins[r]+=1),e.finishReason="goal",e.lifeCycleStage=4}}else"Wall"===f?(c[u.r][u.c]=r+1,m[r]+=1):console.error("unexpected action type",f)}if(e.moveHistory.push({index:o+1,actions:t,grid:c,playerPos:i,timeLeft:s,distances:[G(c,i[0],M[0]),G(c,i[1],M[1])],wallCounts:m}),1===e.lifeCycleStage&&0===o?e.lifeCycleStage=2:2===e.lifeCycleStage&&1===o&&(e.lifeCycleStage=3),e.ghostAction=null,e.viewIndex=o+1,e.premoveActions.length>0){var p=e.premoveActions;e.premoveActions=[];for(var y=0;y<p.length;y++)ne(e,p[y],!0,!1)}}}},ee=new E.a(S.a),te=function(){ee.play()},ne=function(e,t,n,a){if(n){if(!(e.lifeCycleStage<1)&&!(e.lifeCycleStage>3)&&e.viewIndex===B(e)&&!(t.r<0||t.r>=H.h||t.c<0||t.c>=H.w)){var o=R(t);if(!(e.lifeCycleStage<3&&"Wall"===o)){var r=F(e),l=0===r?1:0,i=V(e.ghostAction),c="Wall"===i?[e.ghostAction]:[],s=B(e),m=e.moveHistory[s].playerPos[r];"Wall"===o&&"Ground"===i&&(m=e.ghostAction);var d=J(e.moveHistory[s].grid,t,m,e.moveHistory[s].playerPos[l],M[r],M[l],c);if(!(d>2)){var u=null,f=null;if("None"===i){if("Wall"===o){if(1!==d)return;f=t}else if("Ground"===o)if(1===d)f=t;else{if(2!==d)return;u=[t]}}else if("Wall"===i){if("Wall"===o)if(j(e.ghostAction,t))f=null;else{if(1!==d)return;u=[t,e.ghostAction]}else if("Ground"===o)if(0===d)f=null;else{if(1!==d)return;u=[t,e.ghostAction]}}else if("Ground"===i){if("Wall"===o){if(1!==d)return;u=[t,e.ghostAction]}else if("Ground"===o)if(0===d)f=null;else if(1===d)f=j(t,e.ghostAction)?null:t;else{if(2!==d)return;u=[t]}}else console.error("unexpected ghost type",i);if(u){var g=F(e),h=B(e),p=e.moveHistory[h].timeLeft[g];3===e.lifeCycleStage&&(p+=e.timeControl.increment),e.moveToSend={actions:u,remainingTime:p},a&&e.isVolumeOn&&te(),$(e,u,p,B(e)+1)}else e.ghostAction=f}}}}else ae(e,t)},ae=function(e,t){if(!(e.lifeCycleStage>3)&&e.viewIndex===B(e)&&!(t.r<0||t.r>=H.h||t.c<0||t.c>=H.w)){var n=R(t);if(!(e.lifeCycleStage<2&&"Wall"===n)){for(var a=0===F(e)?1:0,o=0===a?1:0,r=B(e),l=[],i=null,c=0;c<e.premoveActions.length;c++){var s=e.premoveActions[c];"Wall"===R(s)?l.push(s):i=s}var m=e.moveHistory[r].playerPos[a];"Wall"===n&&i&&(m=i);var d=J(e.moveHistory[r].grid,t,m,e.moveHistory[r].playerPos[o],M[a],M[o],l),u=null;if(i&&(u=J(e.moveHistory[r].grid,i,e.moveHistory[r].playerPos[a],e.moveHistory[r].playerPos[o],M[a],M[o],l)),!(d>2)){var f;if(0===e.premoveActions.length)f="Empty";else if(i||1!==l.length)if(i||2!==l.length)if(i&&1===l.length)f="GroundWall";else if(i&&1===u)f="GroundDist1";else{if(!i||2!==u)return void console.error("Unknown premove state",i,l,d,u);f="GroundDist2"}else f="WallWall";else f="Wall";var g=[];if(j(t,m))return 0===e.premoveActions.length?void 0:void(e.premoveActions=[]);var h=null,p=null;if(1===l.length){var y=[l[0],null];h=y[0],p=y[1]}else if(2===l.length){var v=[l[0],l[1]];h=v[0],p=v[1]}if("Empty"===f)if("Wall"===n){if(1!==d)return;g=[t]}else"Ground"===n&&(1===d||2===d?g=[t]:console.error("unreachable case"));else if("Wall"===f){if("Wall"===n)if(j(h,t))g=[];else{if(1!==d)return;g=[h,t]}else if("Ground"===n){if(1!==d)return;g=[h,t]}}else if("WallWall"===f){if("Wall"===n)if(j(h,t))g=[p];else{if(!j(p,t))return;g=[h]}else if("Ground"===n)return}else if("GroundDist1"===f)if("Wall"===n){if(1!==d)return;g=[i,t]}else"Ground"===n&&(g=j(t,i)?[]:[t]);else if("GroundDist2"===f){if("Wall"===n)return;"Ground"===n&&(g=j(t,i)?[]:[t])}else if("GroundWall"===f){if("Wall"===n){if(!j(t,h))return;g=[i]}else if("Ground"===n)if(j(t,i))g=[h];else{if(1!==d)return;g=[h,t]}}else console.error("unexpected premove state case",f);g&&(e.premoveActions=g)}}}},oe=function(e){e.showRematchDialog=!1,e.showDrawDialog=!1,e.showTakebackDialog=!1},re=function(e,t){3===e.lifeCycleStage&&(e.isVolumeOn&&te(),e.lifeCycleStage=4,e.winner="draw",e.gameWins[0]+=.5,e.gameWins[1]+=.5,e.finishReason=t,e.ghostAction=null,oe(e))},le=function(e,t){3===e.lifeCycleStage&&(e.lifeCycleStage=4,e.winner=t?"joiner":"creator",e.gameWins[t?1:0]+=1,e.finishReason="resign",e.ghostAction=null,oe(e))},ie=function(e,t){if(e.showTakebackDialog=!1,2===e.lifeCycleStage||3===e.lifeCycleStage){for(var n=t===_(e)?2:1,a=0;a<n;a++)e.moveHistory.pop();e.ghostAction=null;var o=B(e);e.viewIndex=o,0===o?e.lifeCycleStage=1:1===o&&(e.lifeCycleStage=2)}},ce=function(e){if(4===e.lifeCycleStage){e.creatorStarts=!e.creatorStarts;var t=N(H);e.moveHistory=[{index:0,actions:[],grid:t,playerPos:z,timeLeft:[60*e.timeControl.duration,60*e.timeControl.duration],distances:[G(t,z[0],M[0]),G(t,z[1],M[1])],wallCounts:[0,0]}],e.winner="",e.finishReason="",e.lifeCycleStage=1,e.viewIndex=0,e.ghostAction=null,e.premoveActions=[],oe(e)}},se=function(e,t){if(3===e.lifeCycleStage){var n=B(e);e.moveHistory[n].timeLeft[t]+=60}},me=function(e,t){e.winner=0===t?"creator":"joiner",e.gameWins[t]+=1,e.finishReason="time",e.lifeCycleStage=4,e.ghostAction=null,e.premoveActions=[],oe(e)},de=n(71),ue=n.n(de),fe="#d2d2d2",ge="#fbe4D6",he="#eaeaea",pe="#f1bfa0",ye="#cccccc",ve=["face","outlet"],we="1px solid #00796d",be=function(e){for(var t=e.grid,n=e.ghostAction,r=e.premoveActions,l=Object(i.a)(e.playerColors,2),c=l[0],s=l[1],m=Object(i.a)(e.playerPos,2),d=m[0],u=m[1],f=Object(i.a)(e.goals,2),g=f[0],h=f[1],p=e.handleClick,y=e.creatorToMove,v=e.groundSize,w=e.wallWidth,b=e.isDarkModeOn,k=e.tokens,E=t.length,C=t[0].length,S=[],x=0;x<E;x++)for(var T=0;T<C;T++)S[x*C+T]={r:x,c:T};var O=Object(i.a)(k,2),N=O[0],P=O[1];"default"===N&&(N=ve[0]),"default"===P&&(P=ve[1]);var D=(E-1)/2,I=(C-1)/2,G=Object(a.useState)(null),W=Object(i.a)(G,2),L=W[0],A=W[1],M=function(){A(null)},H=.8*v,z="white";return b&&(z="black"),o.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(I,", ").concat(v,"px ").concat(w,"px) ").concat(v,"px"),gridTemplateRows:"repeat(".concat(D,", ").concat(v,"px ").concat(w,"px) ").concat(v,"px"),justifyContent:"center",gridArea:"board",MozUserSelect:"none",WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none"}},S.map((function(e){var a,l=[j(e,d),j(e,u)],i=l[0],m=l[1],f=[j(e,g),j(e,h)],w=f[0],k=f[1],S=null!==n&&j(n,e),x=r.length>0&&j(r[0],e)||r.length>1&&j(r[1],e),T=S&&y||x&&!y,O=S&&!y||x&&y,D=R(e);a="Ground"===D?L&&j(e,L)?ge:fe:"Wall"===D?L&&j(e,L)?pe:he:ye,b&&(a=ue()(a));var I="";"Ground"===D&&(I+=" waves-effect waves-light"),"Wall"===D&&(I+=" waves-effect waves-dark");var G=i||m||T||O,W=v>27&&!(G||w||k),B=W&&e.r===E-1&&e.c%2===0,_=W&&e.c===C-1&&e.r%2===0,F=B||_;if((w||k)&&(I=w?c:s,I+=b?" darken-4":" lighten-4"),"Wall"===D){var V=0!==t[e.r][e.c];(V||S||x)&&(V?(I=1===t[e.r][e.c]?c:s,I+=b?"":" darken-3"):S?(I=y?c:s,I+=b?" lighten-2":" lighten-3"):(I=y?s:c,I+=b?" lighten-2":" lighten-3"))}var q="center";F&&(q=B?"start":"flex-end");var J="center";return F&&(J=B?"flex-end":"flex-start"),o.a.createElement("div",{className:I,key:"cell_".concat(e.r,"_").concat(e.c),onClick:function(){"Pillar"!==D&&null!==p&&p(e)},onMouseEnter:function(){return function(e){A(e)}(e)},onMouseLeave:M,style:{backgroundColor:a,display:"flex",justifyContent:q,alignItems:J,cursor:"pointer",borderTop:0===e.r?we:"",borderBottom:e.r===E-1?we:"",borderLeft:0===e.c?we:"",borderRight:e.c===C-1?we:""}},i&&o.a.createElement("i",{className:"material-icons ".concat(c,"-text"),style:{fontSize:"".concat(H,"px")}},N),m&&o.a.createElement("i",{className:"material-icons ".concat(s,"-text"),style:{fontSize:"".concat(H,"px")}},P),w&&!G&&o.a.createElement("i",{className:"material-icons white-text",style:{fontSize:"".concat(H,"px")}},N),k&&!G&&o.a.createElement("i",{className:"material-icons white-text",style:{fontSize:"".concat(H,"px")}},P),T&&"Ground"===D&&o.a.createElement("i",{className:"material-icons ".concat(c,"-text text-lighten-4"),style:{fontSize:"".concat(H,"px")}},N),O&&"Ground"===D&&o.a.createElement("i",{className:"material-icons ".concat(s,"-text text-lighten-4"),style:{fontSize:"".concat(H,"px")}},P),B&&o.a.createElement("div",{style:{color:z,padding:"0",marginLeft:"4px"}},String.fromCharCode(97+e.c/2)),_&&o.a.createElement("div",{style:{color:z,padding:"0",marginRight:"4px"}},""+(1+e.r/2)))})))},ke=(n(158),n(72)),Ee=(n(162),function(e){var t,n=e.icon,a=e.tooltip,r=e.onClick,l=e.modalTitle,i=e.modalBody,c=e.modalConfirmButtonText,s=e.bgColor,m=e.padding,d=e.disabled;if(!i)return o.a.createElement(f.Button,{className:s||"teal",node:"button",waves:"light",icon:o.a.createElement(f.Icon,{className:"large"},n),onClick:r,tooltip:a,disabled:d});t=c&&""!==c?[o.a.createElement(f.Button,{style:{backgroundColor:"#009688",color:"white",marginRight:"1rem"},flat:!0,modal:"close",node:"button",waves:"green",onClick:r},c),o.a.createElement(f.Button,{style:{backgroundColor:"#009688",color:"white"},flat:!0,modal:"close",node:"button",waves:"green"},"Cancel")]:o.a.createElement(f.Button,{style:{backgroundColor:"#009688",color:"white"},flat:!0,modal:"close",node:"button",waves:"green"},"Close");var u=o.a.createElement(f.Button,{style:{padding:"0px ".concat(m,"px")},className:s||"teal",node:"button",waves:"light",icon:o.a.createElement(f.Icon,{className:"large"},n),tooltip:a,disabled:d});return o.a.createElement(f.Modal,{style:{color:"black",backgroundColor:"white"},bottomSheet:!1,fixedFooter:!1,header:l,open:!1,options:{dismissible:!0,endingTop:"10%",inDuration:250,opacity:.4,outDuration:250,preventScrolling:!0,startingTop:"4%"},trigger:u,actions:t},o.a.createElement("div",null,i))});var Ce=function(e){var t,n=e.context,a=e.helpText,r=e.aboutText,l=e.joinCode,i=e.handleLeaveGame,c=e.isLargeScreen,s=e.isDarkModeOn,m=e.handleToggleDarkMode;t="Lobby"===n?o.a.createElement("span",null,"WallWars"):"Spectator"===n?o.a.createElement("span",{style:{cursor:"pointer"},onClick:i},"WallWars"):o.a.createElement("span",null,c&&o.a.createElement("span",{style:{cursor:"pointer"},onClick:i},"WallWars"),c&&o.a.createElement("span",null,"\xa0"),o.a.createElement(ke.CopyToClipboard,{style:{cursor:"pointer"},text:l,onCopy:function(){return x("Join code copied to clipboard!")}},o.a.createElement("span",null,"Code ",l)));var d=s?"red darken-4":"red lighten-1",u=c?20:11;return o.a.createElement("div",null,o.a.createElement("div",{className:d,style:{height:"50px",display:"grid",gridTemplateRows:"1fr",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"}},o.a.createElement("div",{style:{fontSize:c?"30px":"25px",marginLeft:c?"15px":"5px"}},t),o.a.createElement("div",{style:{height:"auto",display:"grid",padding:"5px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"auto",columnGap:"5px",rowGap:"5px",marginRight:c?"15px":"5px"}},o.a.createElement(Ee,{icon:s?"brightness_2":"brightness_4",tooltip:s?"Turn off dark mode":"Turn on dark mode",onClick:m,bgColor:"red darken-1",padding:u}),o.a.createElement(Ee,{icon:"help",tooltip:"Help",modalTitle:"Help",modalBody:a,bgColor:"red darken-1",padding:u}),"Lobby"===n&&o.a.createElement(Ee,{icon:"info",tooltip:"About",modalTitle:"About",modalBody:r,bgColor:"red darken-1",padding:u}),"Lobby"!==n&&o.a.createElement(Ee,{icon:"home",tooltip:"Leave game",onClick:i,bgColor:"red darken-1",padding:u}))))},Se=function(e){var t=e.title,n=e.body,a=e.acceptButtonText,r=e.rejectButtonText,l=e.isOpen,i=e.callback;return o.a.createElement(f.Modal,{style:{color:"black",backgroundColor:"white"},header:t,open:l,options:{dismissible:!1,endingTop:"10%",inDuration:250,opacity:.4,outDuration:250,preventScrolling:!0,startingTop:"4%"},actions:[o.a.createElement(f.Button,{style:{backgroundColor:"#009688",color:"white",marginRight:"1rem"},flat:!0,modal:"close",node:"button",waves:"green",onClick:function(){i(!0)}},a||"Accept"),o.a.createElement(f.Button,{style:{backgroundColor:"#009688",color:"white"},flat:!0,modal:"close",node:"button",waves:"green",onClick:function(){i(!1)}},r||"Cancel")]},o.a.createElement("div",null,n))},xe=function(e){var t,n=e.names,a=e.lifeCycleStage,r=e.winner,l=e.finishReason,i=e.indexToMove,c=e.timeControl,s=e.creatorStarts,m=e.isLargeScreen,d=n[i];switch(a){case-2:t="Haven't tried to connect to the server yet";break;case-1:t="Waking the server up...";break;case 0:t="Waiting for player 2 to join";break;case 1:t="".concat(d," starts");break;case 2:case 3:t="".concat(d," to move");break;case 4:t="draw"===r?"The game ended in a draw "+{goal:"by the 1-move rule",agreement:"by agreement"}[l]:"".concat(n["creator"===r?0:1]," won ").concat({time:"on time",goal:"by reaching the goal",resign:"by resignation",abandon:"by abandonment"}[l]);break;default:console.error("stage should be in range [-2..4]")}var u=function(e){return Math.round(100*(e+Number.EPSILON))/100},f="";return 0===a&&s?f=n[0]:a>0&&(f=n[s?0:1]),o.a.createElement("div",{className:"teal darken-2",style:{display:"grid",gridTemplateColumns:"auto",gridTemplateRows:"1fr 1fr 1fr",alignItems:"center",padding:m?"15px 15px":"5px 15px",gridArea:"status"}},o.a.createElement("div",null,o.a.createElement("p",null,t)),o.a.createElement("div",null,c&&o.a.createElement("p",null,"Time control: ",u(c.duration),"+",u(c.increment))),o.a.createElement("div",null,o.a.createElement("p",null,"First move: "+f)))},Te=function(e,t){return o.a.createElement("span",{style:{height:"10px",width:"10px",backgroundColor:e,borderRadius:"50%",display:"inline-block",border:"solid 1px black"},title:t})},Oe=function(e,t){return e?Te("#67ff36","".concat(t," has the game open")):Te("gray","".concat(t," does not have the game page open"))},Re=function(e){var t=e.lifeCycleStage,n=e.names,a=e.playerColors,r=e.timeLeft,l=e.indexToMove,i=e.isLargeScreen,c=e.scores,s=e.arePlayersPresent,m=[Math.floor(r[0]/60),Math.floor(r[1]/60)],d=m[0],u=m[1],f=r[0]%60,g=r[1]%60,h=["".concat(d,":").concat(f<10?"0":"").concat(f),"".concat(u,":").concat(g<10?"0":"").concat(g)];t<0&&(h[0]="_:__",h[1]="_:__");var p=["",""];if(t<4){p[l]=a[l]+" lighten-1 z-depth-2"}var y=["",""];3===t&&(0===l?r[0]<15&&(y[0]=" orange lighten-2 z-depth-2"):1===l&&r[1]<15&&(y[1]=" orange lighten-2 z-depth-2"));var v,w=0!==c[0]||0!==c[1],b={padding:v=i&&!w?"15px":i&&w?"12px":i||w?"6px":"8px",fontSize:i?"18px":"14px"};return o.a.createElement("div",{className:"teal darken-2",style:{display:"grid",gridTemplateColumns:w?"0.5fr 1.7fr 0.2fr 1fr 1fr 0.2fr 1.7fr 0.5fr":"1.7fr 0.2fr 1fr 1fr 0.2fr 1.7fr",gridTemplateRows:"auto",alignContent:"center",columnGap:v,padding:v,gridArea:"timer"}},w&&o.a.createElement("div",{style:b,className:"center"},c[0]),o.a.createElement("div",{style:b,className:p[0]+" center truncate"},n[0]),o.a.createElement("div",{style:b,className:"center"},Oe(s[0],n[0])),o.a.createElement("div",{style:b,className:y[0]+" center"},h[0]),o.a.createElement("div",{style:b,className:y[1]+" center"},h[1]),o.a.createElement("div",{style:b,className:"center"},Oe(s[1],n[1])),o.a.createElement("div",{style:b,className:p[1]+" center truncate"},null===n[1]?"______":n[1]),w&&o.a.createElement("div",{style:b,className:"center"},c[1]))},je=o.a.createElement("div",null,o.a.createElement("h6",null,'To connect with your friend, share the game code in the top header with them and tell them to use it when clicking "Join Game" from the lobby. Click on the code to copy it to the clipboard.'),o.a.createElement("h6",null,"Rules of the game:"),o.a.createElement("h6",null,"The player who creates the game starts at the top left corner (color red). The player who joins the game starts at the top right (color blue). The goal of each player is to reach the ",o.a.createElement("em",null,"opposite")," corner from where they start. The player who gets there first wins."),o.a.createElement("h6",null,"Players move by clicking cells on the board. There are two types of cells: ground cells (the big squares) and walls (the thin rectangles in between ground cells). Each move consists of a total of two actions. One action can be building one wall or moving to an adjacent cell. A diagonal move counts as two actions."),o.a.createElement("h6",null,"Players can build walls to obstruct the opponent. Walls can be built anywhere as long as there always exists at least one way to get to their goal. You cannot go through your own walls either."),o.a.createElement("h6",null,"The remaining time for each player is shown next to their name. The clock of a player ticks down when it is their turn (after each player has moved once). The player who starts is chosen randomly. The name of the player to move next is highlighted with their color."),o.a.createElement("h6",null,"If it is your turn and you do a single action, like building a wall or moving to an adjacent cell, you can undo it by clicking the wall again or clicking a different ground cell, respectively. Once you choose 2 actions, the move becomes permanent."),o.a.createElement("h6",null,"During the opponent's turn, you can ",o.a.createElement("em",null,"premove"),", meaning choose a move that will be applied instantaneously when it is your turn."),o.a.createElement("h6",null,"Special rules:"),o.a.createElement("h6",null,"(1) no walls can be placed during the first move of each player."),o.a.createElement("h6",null,"(2) if the player who moved first reaches the goal first but the other player is at distance 1 or 2 from their goal, the game ends in a draw."),o.a.createElement("h6",null,"If you leave the game, you will be able to reenter this game as long as you don't create or join a new game.")),Ne={position:"sticky",top:"0px",paddingTop:"0.15rem",paddingBottom:"0.15rem",borderRadius:"0"},Pe={paddingTop:"0.15rem",paddingBottom:"0.15rem",borderRadius:"0"},De=function(e){var t=e.moveHistory,n=e.playerColors,a=e.creatorStarts,r=e.handleViewMove,l=e.viewIndex,i=e.height;return o.a.createElement("div",{id:"movehistory",className:"center",style:{overflowY:"scroll",display:"block",height:i,MozUserSelect:"none",WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none"}},o.a.createElement(f.Table,{centered:!0,style:{width:"100%"}},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"teal darken-2",style:Ne},"Move"),o.a.createElement("th",{className:"teal darken-2",style:Ne},"Actions"),o.a.createElement("th",{className:"teal darken-2",style:Ne},"Distance"),o.a.createElement("th",{className:"teal darken-2",style:Ne},"# Walls"))),o.a.createElement("tbody",null,t.map((function(e,i){var c;return 0===i?c=void 0:(c=a?n[(i+1)%2]:n[i%2],c+=" lighten-2"),l===i&&i<t.length-1&&(c="amber darken-1"),o.a.createElement("tr",{onClick:function(){return r(i)},style:{cursor:"pointer"},key:i,className:c},o.a.createElement("td",{style:Pe},i),o.a.createElement("td",{style:Pe},function(e){if(0===e.index)return"__";for(var t=0,n=0;n<e.actions.length;n++){"Wall"===R(e.actions[n])&&(t+=1)}return 0===t?"GG":1===t?"GW":"WW"}(e)),o.a.createElement("td",{style:Pe},e.distances[0]+" - "+e.distances[1]),o.a.createElement("td",{style:Pe},e.wallCounts[0]+" - "+e.wallCounts[1]))})))))},Ie=function(e){var t=e.lifeCycleStage,n=e.handleResign,a=e.handleOfferDraw,r=e.handleRequestTakeback,l=e.handleGiveExtraTime,i=e.moveHistory,c=e.playerColors,s=e.clientRole,m=e.creatorStarts,d=e.handleViewMove,u=e.viewIndex,f=e.turnCount,g=e.handleSeeFirstMove,h=e.handleSeePreviousMove,p=e.handleSeeNextMove,y=e.handleSeeLastMove,v=e.handleToggleVolume,w=e.isVolumeOn,b=e.handleLeaveGame,k=e.handleIncreaseBoardSize,E=e.handleDecreaseBoardSize,C=e.zoomLevel,S=e.boardHeight,T=e.isOpponentPresent,O=S-108-15-10,R=3===t||2===t&&m===("Creator"===s),j="Spectator"===s;return o.a.createElement("div",{className:"teal darken-2",style:{width:"100%",height:"auto",display:"grid",padding:"".concat(5,"px"),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"".concat(36,"px 1fr ").concat(36,"px ").concat(36,"px"),columnGap:"".concat(5,"px"),rowGap:"".concat(5,"px"),gridArea:"panel"}},o.a.createElement(Ee,{icon:"flag",tooltip:"Resign",modalTitle:"Resign",modalBody:"Are you sure you want to resign?",modalConfirmButtonText:"Resign",onClick:n,disabled:j||3!==t}),o.a.createElement(Ee,{icon:"local_florist",tooltip:"Offer Draw",modalTitle:"Offer Draw",modalBody:"Are you sure you want to offer a draw?",modalConfirmButtonText:"Offer draw",onClick:a,disabled:j||!T||3!==t}),o.a.createElement(Ee,{icon:"replay",tooltip:"Request takeback",onClick:function(){x("A takeback request was sent to the opponent.",5e3),r()},disabled:j||!T||!R}),o.a.createElement(Ee,{icon:"add_alarm",tooltip:"Give 60 seconds",onClick:function(){x("You added 60s to the opponent's clock.",5e3),l()},disabled:j||3!==t}),o.a.createElement("div",{style:{gridColumnStart:"1",gridColumnEnd:"5"}},o.a.createElement(De,{moveHistory:i,playerColors:c,creatorStarts:m,handleViewMove:d,viewIndex:u,height:O})),o.a.createElement(Ee,{icon:"fast_rewind",onClick:g,disabled:t<=1||0===u}),o.a.createElement(Ee,{icon:"navigate_before",onClick:h,disabled:t<=1||0===u}),o.a.createElement(Ee,{icon:"navigate_next",onClick:p,disabled:t<=1||u===f}),o.a.createElement(Ee,{icon:"fast_forward",onClick:y,disabled:t<=1||u===f}),o.a.createElement(Ee,{icon:w?"volume_up":"volume_off",tooltip:w?"Turn off sound effects":"Turn on sound effects",onClick:v,disabled:j}),o.a.createElement(Ee,{icon:"zoom_out",tooltip:"Decrease board size",onClick:E,disabled:0===C}),o.a.createElement(Ee,{icon:"zoom_in",tooltip:"Increase board size",onClick:k,disabled:10===C}),o.a.createElement(Ee,{icon:"home",tooltip:"Leave game",onClick:b}))},Ge=new E.a(S.a),We=function(){Ge.play()},Le=w.boardDims,Ae=function(e){var t=e.socket,n=e.clientParams,r=e.returnToLobby,l=e.isLargeScreen,c=e.isDarkModeOn,s=e.handleToggleDarkMode,m=e.handleSetCookieId,d=Object(y.a)(["isVolumeOn","zoomLevel"]),u=Object(i.a)(d,2),g=u[0],h=u[1],p=Object(b.a)(function(e){var t={joinCode:null,timeControl:null,names:[null,null],tokens:["default","default"],gameWins:[0,0],opponentAbandoned:!1,arePlayersPresent:[!1,!1],creatorStarts:null,winner:"",finishReason:"",lifeCycleStage:-2,moveHistory:[{index:0,actions:[],grid:N(H),playerPos:z,timeLeft:[null,null],distances:[G(N(H),z[0],M[0]),G(N(H),z[1],M[1])],wallCounts:[0,0]}],clientRole:null,moveToSend:null,ghostAction:null,premoveActions:[],isVolumeOn:!1,isKeyPressed:!1,viewIndex:0,zoomLevel:5,waitingForPing:0,showDrawDialog:!1,showTakebackDialog:!1,showRematchDialog:!1};return U(t,e),t}(g)),v=Object(i.a)(p,2),k=v[0],E=v[1];Object(a.useEffect)((function(){return t.once("gameCreated",(function(e){var t=e.joinCode,n=e.creatorStarts,a=e.cookieId;m(a),E((function(e){Q(e,t,n)}))})),t.once("gameJoined",(function(e){var t=e.creatorName,n=e.creatorToken,a=e.timeControl,o=e.creatorStarts,r=e.cookieId,l=e.creatorPresent;m(r),E((function(e){X(e,t,n,a,o,l)}))})),t.once("requestedGame",(function(e){var t=e.game;E((function(e){!function(e,t){Y(e,t.timeControl,t.playerNames[0],t.playerTokens[0]),Q(e,t.joinCode,t.creatorStarts),Z(e,t.playerNames[1],t.playerTokens[1]);for(var n=0;n<t.moveHistory.length;n++){var a=t.moveHistory[n].actions,o=t.moveHistory[n].remainingTime;$(e,a,o,n+1)}e.clientRole="Spectator",e.gameWins=t.gameWins,e.winner=t.winner,e.finishReason=t.finishReason,e.lifeCycleStage=4}(e,t)}))})),t.on("returnedToOngoingGame",(function(e){var t=e.ongoingGame,a=e.timeLeft;E((function(e){!function(e,t,n,a){"Creator"===(t===n.cookieIds[0]?"Creator":"Joiner")?(Y(e,n.timeControl,n.playerNames[0],n.playerTokens[0]),Q(e,n.joinCode,n.creatorStarts),Z(e,n.playerNames[1],n.playerTokens[1])):(K(e,n.joinCode,n.playerNames[1],n.playerTokens[1]),X(e,n.playerNames[0],n.playerTokens[0],n.timeControl,n.creatorStarts,!0)),e.arePlayersPresent=n.arePlayersPresent;for(var o=0;o<n.moveHistory.length;o++){var r=n.moveHistory[o].actions,l=n.moveHistory[o].remainingTime;$(e,r,l,o+1)}e.gameWins=n.gameWins,e.winner=n.winner,e.finishReason=n.finishReason;var i=B(e);e.moveHistory[i].timeLeft=a,""!==n.winner?e.lifeCycleStage=4:0===a[0]?me(e,1):0===a[1]&&me(e,0)}(e,n.cookieId,t,a),e.waitingForPing=0}))})),t.on("opponentReturned",(function(){E((function(e){e.arePlayersPresent["Creator"===e.clientRole?1:0]=!0,e.waitingForPing=0}))})),t.on("ongoingGameNotFound",(function(){x("Couldn't find the game anymore.",5e3),r()})),t.once("gameJoinFailed",(function(){x("There is no game with this code waiting for someone to join.",5e3),r()})),t.on("gameNotFoundError",(function(){x("There was an issue on the server and we couldn't reach the other player.",5e3),E((function(e){e.waitingForPing=0}))})),t.once("joinerJoined",(function(e){var t=e.joinerName,n=e.joinerToken;E((function(e){1!==e.lifeCycleStage&&(e.isVolumeOn&&We(),Z(e,t,n),e.arePlayersPresent[1]=!0,e.waitingForPing=0)}))})),t.on("drawOffered",(function(){E((function(e){e.showDrawDialog=!0,e.waitingForPing=0}))})),t.on("drawRejected",(function(){x("The opponent declined the draw offer.",5e3),E((function(e){e.waitingForPing=0}))})),t.on("drawAccepted",(function(){x("The opponent accepted the draw offer.",5e3),E((function(e){re(e,"agreement"),e.waitingForPing=0}))})),t.on("takebackRequested",(function(){E((function(e){e.showTakebackDialog=!0,e.waitingForPing=0}))})),t.on("takebackRejected",(function(){x("The opponent declined the takeback request.",5e3),E((function(e){e.waitingForPing=0}))})),t.on("takebackAccepted",(function(){x("The opponent agreed to the takeback.",5e3),E((function(e){var t="Creator"===e.clientRole;ie(e,t),e.waitingForPing=0}))})),t.on("rematchOffered",(function(){E((function(e){e.showRematchDialog=!0,e.waitingForPing=0}))})),t.on("rematchRejected",(function(){x("The opponent declined the rematch offer.",5e3),E((function(e){e.waitingForPing=0}))})),t.on("rematchAccepted",(function(){x("The opponent accepted the rematch offer.",5e3),E((function(e){e.isVolumeOn&&We(),ce(e),e.waitingForPing=0}))})),t.on("extraTimeReceived",(function(){x("The opponent added 60s to your clock.",5e3),E((function(e){var t="Creator"===e.clientRole?0:1;se(e,t),e.waitingForPing=0}))})),t.on("resigned",(function(){x("The opponent resigned.",5e3),E((function(e){e.isVolumeOn&&We();var t="Creator"!==e.clientRole;le(e,t),e.waitingForPing=0}))})),t.on("moved",(function(e){var t=e.actions,n=e.moveIndex,a=e.remainingTime;E((function(e){console.log("move ".concat(n," received (").concat(a,"s)")),e.isVolumeOn&&We(),$(e,t,a,n),e.waitingForPing=0}))})),t.on("leftGame",(function(){E((function(e){e.arePlayersPresent["Creator"===e.clientRole?1:0]=!1,e.waitingForPing=0}))})),t.on("abandonedGame",(function(){x("The opponent abandoned the game.",5e3),E((function(e){!function(e,t){4!==e.lifeCycleStage&&(e.lifeCycleStage=4,e.winner=t?"joiner":"creator",e.gameWins[t?1:0]+=1,e.finishReason="abandon",e.ghostAction=null,oe(e))}(e,"Creator"!==e.clientRole),e.waitingForPing=0}))})),t.on("pongFromServer",(function(){E((function(e){e.waitingForPing=0}))})),function(){t.removeAllListeners()}}),[t,E,r,m,n.cookieId]),Object(a.useEffect)((function(){-2===k.lifeCycleStage&&("Creator"===n.clientRole?(E((function(e){Y(e,n.timeControl,n.name,n.token),e.arePlayersPresent[0]=!0})),t.emit("createGame",{name:n.name,timeControl:n.timeControl,token:n.token,cookieId:n.cookieId})):"Joiner"===n.clientRole?(E((function(e){K(e,n.joinCode,n.name,n.token),e.arePlayersPresent[1]=!0})),t.emit("joinGame",{joinCode:n.joinCode,name:n.name,token:n.token,cookieId:n.cookieId})):"Spectator"===n.clientRole?t.emit("getGame",{gameId:n.gameId}):"Returner"===n.clientRole?t.emit("returnToOngoingGame",{cookieId:n.cookieId}):console.error("unknown client role",n.clientRole))}));var C=function(){t.emit("leaveGame"),r()};Object(a.useEffect)((function(){var e=setInterval((function(){E((function(e){!function(e){if(3===e.lifeCycleStage){var t=F(e),n=B(e);e.moveHistory[n].timeLeft[t]-=1,0===e.moveHistory[n].timeLeft[t]&&me(e,0===t?1:0)}}(e)}))}),1e3);return function(){return clearInterval(e)}}),[E]),Object(a.useEffect)((function(){var e=setInterval((function(){3===k.lifeCycleStage&&(1===k.waitingForPing?t.emit("pingServer"):2===k.waitingForPing&&x("The server is not responding. The game is probably lost. Sorry for the inconvenience.",8e3),E((function(e){e.waitingForPing=(e.waitingForPing+1)%3})))}),5e3);return function(){return clearInterval(e)}}),[t,k.lifeCycleStage,k.waitingForPing,E]);var S=function(e){E((function(t){var n=_(t)===("Creator"===t.clientRole);ne(t,e,n,!0)}))};Object(a.useEffect)((function(){k.moveToSend&&(t.emit("move",k.moveToSend),E((function(e){e.moveToSend=null})))})),Object(a.useEffect)((function(){"Spectator"!==k.clientRole&&("goal"===k.finishReason&&t.emit("playerReachedGoal",{winner:k.winner}),"time"===k.finishReason&&t.emit("playerWonOnTime",{winner:k.winner}))}),[t,k.clientRole,k.winner,k.finishReason]);Object(a.useEffect)((function(){return window.addEventListener("keydown",T),window.addEventListener("keyup",O),function(){window.removeEventListener("keydown",T),window.removeEventListener("keyup",O)}}));var T=function(e){var t=e.key;if(!k.isKeyPressed)if(E((function(e){e.isKeyPressed=!0})),"m"!==t)if(k.viewIndex<B(k)||4===k.lifeCycleStage)"ArrowDown"===t||"ArrowRight"===t?k.viewIndex<B(k)&&E((function(e){e.viewIndex+=1})):"ArrowUp"!==t&&"ArrowLeft"!==t||k.viewIndex>0&&E((function(e){e.viewIndex-=1}));else{var n;if(k.ghostAction&&"Ground"===V(k.ghostAction))n=k.ghostAction;else{var a=B(k);n=k.moveHistory[a].playerPos[F(k)]}if("ArrowDown"===t)n={r:n.r+2,c:n.c};else if("ArrowUp"===t)n={r:n.r-2,c:n.c};else if("ArrowLeft"===t)n={r:n.r,c:n.c-2};else{if("ArrowRight"!==t)return;n={r:n.r,c:n.c+2}}S(n)}else D()},O=function(){E((function(e){e.isKeyPressed=!1}))},R=function(e){e<0||e>B(k)||E((function(t){t.viewIndex!==e&&(e>B(t)||(t.viewIndex=e,t.ghostAction=null))}))};Object(a.useEffect)((function(){var e=document.getElementById("movehistory");e.scrollTop=e.scrollHeight}),[k.moveHistory]);var j,P,D=function(){h("isVolumeOn",k.isVolumeOn?"false":"true",{path:"/"}),E((function(e){e.isVolumeOn=!e.isVolumeOn}))},I=function(e){e.preventDefault(),C()};if(Object(a.useEffect)((function(){return window.history.pushState(null,null,window.location.pathname),window.addEventListener("popstate",I),function(){return window.removeEventListener("popstate",I)}})),4===k.lifeCycleStage){var W=Object(i.a)(k.moveHistory[k.viewIndex].timeLeft,2);j=W[0],P=W[1]}else{var L=B(k),A=Object(i.a)(k.moveHistory[L].timeLeft,2);j=A[0],P=A[1]}var J,ee,te,ae=l?[w.groundSize,w.wallWidth]:[w.smallScreenGroundSize,w.smallScreenWallWidth],de=Object(i.a)(ae,2),ue=de[0],fe=de[1],ge=Math.pow(1.1,k.zoomLevel-5),he=ue*ge,pe=fe*ge,ye=pe*(Le.h-1)/2+he*(Le.h+1)/2,ve=pe*(Le.w-1)/2+he*(Le.w+1)/2,we=l?15:6;if(l){J="".concat(100,"px ").concat(ye,"px"),ee="".concat(ve,"px ").concat(360,"px"),te="'timer status' 'board panel'"}else{J="".concat(50,"px ").concat(ye,"px ").concat(80,"px ").concat(ye,"px"),ee="".concat(ve,"px"),te="'timer' 'board' 'status' 'panel'"}return o.a.createElement("div",{className:c?"teal darken-4":void 0},o.a.createElement(Ce,{context:"Spectator"===k.clientRole?"Spectator":"Player",joinCode:k.joinCode,helpText:je,handleLeaveGame:C,isLargeScreen:l,isDarkModeOn:c,handleToggleDarkMode:s}),o.a.createElement("div",{style:{display:"grid",gridTemplateRows:J,gridTemplateColumns:ee,gridTemplateAreas:te,columnGap:"".concat(we,"px"),rowGap:"".concat(we,"px"),margin:"".concat(we,"px"),justifyContent:"center",alignContent:"center"}},o.a.createElement(Re,{lifeCycleStage:k.lifeCycleStage,names:k.names,indexToMove:F(k),playerColors:w.playerColors,timeLeft:[j,P],isLargeScreen:l,scores:k.gameWins,arePlayersPresent:k.arePlayersPresent}),o.a.createElement(xe,{lifeCycleStage:k.lifeCycleStage,names:k.names,indexToMove:F(k),winner:k.winner,finishReason:k.finishReason,timeControl:k.timeControl,creatorStarts:k.creatorStarts,isLargeScreen:l}),o.a.createElement(be,{creatorToMove:_(k),playerColors:w.playerColors,grid:k.moveHistory[k.viewIndex].grid,playerPos:k.moveHistory[k.viewIndex].playerPos,goals:w.goals,ghostAction:k.ghostAction,premoveActions:k.premoveActions,handleClick:function(e){return S(e)},groundSize:he,wallWidth:pe,isDarkModeOn:c,tokens:k.tokens}),o.a.createElement(Ie,{lifeCycleStage:k.lifeCycleStage,handleResign:function(){t.emit("resign"),E((function(e){le(e,"Creator"===e.clientRole)}))},handleOfferDraw:function(){t.emit("offerDraw")},handleRequestTakeback:function(){t.emit("requestTakeback")},handleGiveExtraTime:function(){t.emit("giveExtraTime"),E((function(e){var t="Creator"===e.clientRole?1:0;se(e,t)}))},moveHistory:k.moveHistory,playerColors:w.playerColors,clientRole:k.clientRole,creatorStarts:k.creatorStarts,handleViewMove:R,viewIndex:k.viewIndex,turnCount:B(k),handleSeeFirstMove:function(){R(0),document.getElementById("movehistory").scrollTop=0},handleSeePreviousMove:function(){return R(k.viewIndex-1)},handleSeeNextMove:function(){return R(k.viewIndex+1)},handleSeeLastMove:function(){R(B(k));var e=document.getElementById("movehistory");e.scrollTop=e.scrollHeight},handleToggleVolume:D,isVolumeOn:k.isVolumeOn,handleLeaveGame:C,isDarkModeOn:c,handleIncreaseBoardSize:function(){k.zoomLevel<10&&h("zoomLevel",k.zoomLevel+1,{path:"/"}),E((function(e){e.zoomLevel<10&&(e.zoomLevel+=1)}))},handleDecreaseBoardSize:function(){k.zoomLevel>0&&h("zoomLevel",k.zoomLevel-1,{path:"/"}),E((function(e){e.zoomLevel>0&&(e.zoomLevel-=1)}))},zoomLevel:k.zoomLevel,boardHeight:ye,isOpponentPresent:q(k)})),4===k.lifeCycleStage&&"Spectator"!==k.clientRole&&o.a.createElement(f.Row,{className:"valign-wrapper",style:{marginTop:"1rem"}},o.a.createElement(f.Col,{className:"center",s:12},o.a.createElement(f.Button,{large:!0,className:"red",node:"button",waves:"light",onClick:function(){x("Rematch offer sent.",5e3),t.emit("offerRematch")},disabled:!q(k)},"Rematch"))),o.a.createElement(Se,{isOpen:k.showDrawDialog,title:"Draw offer received",body:"The opponent offered a draw.",acceptButtonText:"Accept",rejectButtonText:"Decline",callback:function(e){e?(t.emit("acceptDraw"),E((function(e){re(e,"agreement")}))):(t.emit("rejectDraw"),E((function(e){e.showDrawDialog=!1})))}}),o.a.createElement(Se,{isOpen:k.showRematchDialog,title:"Rematch offer received",body:"The opponent would like a rematch.",acceptButtonText:"Accept",rejectButtonText:"Decline",callback:function(e){e?(t.emit("acceptRematch"),E((function(e){ce(e)}))):(t.emit("rejectRematch"),E((function(e){e.showRematchDialog=!1})))}}),o.a.createElement(Se,{isOpen:k.showTakebackDialog,title:"Takeback request received",body:"The opponent requested a takeback. If you accept, their last move will be undone.",acceptButtonText:"Accept",rejectButtonText:"Decline",callback:function(e){e?(x("The last move played on the board has been undone.",5e3),t.emit("acceptTakeback"),E((function(e){var t="Joiner"===e.clientRole;ie(e,t)}))):(t.emit("rejectTakeback"),E((function(e){e.showTakebackDialog=!1})))}}))},Me=["school","default","face","outlet","mood","mood_bad","child_care","pets","whatshot","toys","spa","stop","star","lens","favorite","visibility","group_work","flare","ac_unit","camera","casino","directions_boat","directions_bus","directions_car","event_seat","adb","bug_report"],He=function(e){var t=e.playerName,n=e.handlePlayerName,r=e.duration,l=e.handleDuration,i=e.increment,c=e.handleIncrement,s=e.joinCode,m=e.handleJoinCode,d=e.handleCreateGame,u=e.handleJoinGame,g=e.handleRefreshName,h=e.token,p=e.handleToken,y=e.isLargeScreen;Object(a.useEffect)((function(){return window.addEventListener("keydown",v),function(){window.removeEventListener("keydown",v)}}));var v=function(e){"Enter"===e.key&&(s.length>0?u():(x("Created new game",5e3),d()))},w=o.a.createElement("div",{className:"white-text",style:{fontSize:"30px"}},o.a.createElement("i",{className:"material-icons white-text",style:{height:"100%"}},"face"),y?" / ":"/",o.a.createElement("i",{className:"material-icons white-text",style:{height:"100%"}},"outlet"));return o.a.createElement("div",{className:"container teal darken-2",style:{marginTop:"2rem"}},o.a.createElement(f.Row,{className:"valign-wrapper"},o.a.createElement(f.Col,{className:"center",s:4,m:4},o.a.createElement("h5",null,y?"Your name:":"Name:")),o.a.createElement(f.Col,{s:6,m:3},o.a.createElement(f.TextInput,{id:"nameInput",value:t,onChange:n})),o.a.createElement(f.Col,{s:1,m:1},o.a.createElement(f.Button,{className:"teal lighten-2",node:"button",waves:"light",small:!0,floating:!0,style:{color:"white"},icon:o.a.createElement(f.Icon,null,"refresh"),onClick:g,tooltip:"Get a new name"})),o.a.createElement(f.Col,{s:1,m:4})),o.a.createElement(f.Row,{className:"valign-wrapper"},o.a.createElement(f.Col,{className:"center",s:4,m:4},o.a.createElement("h5",null,y?"Your token:":"Token:")),o.a.createElement(f.Col,{s:3,m:2,className:"center"},"default"===h?w:o.a.createElement("div",{className:"white-text",style:{fontSize:"30px"}},o.a.createElement("i",{className:"material-icons white-text",style:{height:"100%"}},h))),o.a.createElement(f.Col,{s:4,m:4},o.a.createElement("div",null,o.a.createElement(f.Dropdown,{id:"Dropdown_6",options:{alignment:"left",autoTrigger:!0,closeOnClick:!0,constrainWidth:!0,container:null,coverTrigger:!0,hover:!1,inDuration:150,onCloseEnd:null,onCloseStart:null,onOpenEnd:null,onOpenStart:null,outDuration:250},trigger:o.a.createElement(f.Button,{node:"button"},"Change")},Me.map((function(e){return o.a.createElement("div",{style:{width:"100%"},key:e,className:"teal",node:"button",onClick:function(){return p(e)}},o.a.createElement("div",{className:"center",style:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"4px 0"}},"default"===e?w:o.a.createElement("i",{className:"material-icons white-text",style:{height:"100%"}},e)))}))))),o.a.createElement(f.Col,{s:1,m:2})),o.a.createElement(f.Row,{className:"valign-wrapper"},o.a.createElement(f.Col,{className:"center",s:5,m:4},o.a.createElement(f.Button,{node:"button",waves:"light",onClick:d},"Create game")),o.a.createElement(f.Col,{s:2,m:1,style:{paddingRight:"0"}},o.a.createElement(f.TextInput,{id:"durationInput",label:"Duration",value:"".concat(r),onChange:l})),o.a.createElement(f.Col,{s:1,m:1,style:{paddingLeft:"0"}},"m"),o.a.createElement(f.Col,{s:2,m:1,style:{paddingRight:"0"}},o.a.createElement(f.TextInput,{id:"incrementInput",label:"Increment",value:"".concat(i),onChange:c})),o.a.createElement(f.Col,{s:1,m:1,style:{paddingLeft:"0"}},"s"),o.a.createElement(f.Col,{s:1,m:4})),o.a.createElement(f.Row,{className:"valign-wrapper"},o.a.createElement(f.Col,{className:"center",s:5,m:4},o.a.createElement(f.Button,{node:"button",waves:"light",onClick:u},"Join game")),o.a.createElement(f.Col,{s:6,m:5},o.a.createElement(f.TextInput,{id:"joinInput",placeholder:"Write game code here...",value:"".concat(s),onChange:m})),o.a.createElement(f.Col,{s:1,m:3})))},ze=o.a.createElement("div",null,o.a.createElement("h6",null,"This is the lobby. From here, you can create games that your friends can join, or join a friend's game."),o.a.createElement("h6",null,"When you create a game, you can choose the ",o.a.createElement("em",null,"duration")," (per player) and a time",o.a.createElement("em",null,"increment")," that is added to each player after they move. Once you create a game, a ",o.a.createElement("em",null,"game code")," will appear at the top. Share this code with your friend to play with them."),o.a.createElement("h6",null,'To join a friend\'s game, write the code they give you in the box next to the "Join game" button and click it.'),o.a.createElement("h6",null,"To get a feel for the game, you can watch some of the recent games listed in the lobby."),o.a.createElement("h6",null,"A random ",o.a.createElement("em",null,"username")," has been chosen for you, but you can change it. You can also choose the look of your token.")),Be=o.a.createElement("div",null,o.a.createElement("h6",null,"Wallwars is an online 2-player strategy game. The player who gets to their goal before first wins. You can place walls to reshape the terrain to your advantage."),o.a.createElement("h6",null,"WallWars is inspired by board games like Blockade and Quoridor. The main difference is that in WallWars there is no limit to how many walls you can place, and moves are more flexible (for instance, you can move and place a wall in the same turn)."),o.a.createElement("h6",null,"The source code is available at https://github.com/nmamano/WallWars")),_e=function(e){var t=e.socket,n=e.isLargeScreen,r=e.isDarkModeOn,l=e.handleViewGame,c=Object(b.a)({game:null,nextMove:0,grid:N(w.boardDims),playerPos:w.initialPlayerPos,needToRequestGame:!0,finishedGameWait:3}),s=Object(i.a)(c,2),m=s[0],d=s[1];return Object(a.useEffect)((function(){var e=setInterval((function(){if(m.needToRequestGame)return d((function(e){e.needToRequestGame=!1})),void t.emit("getRandomGame");m.game&&(m.game.moveHistory?m.nextMove!==m.game.moveHistory.length?d((function(e){if(e.game&&e.game.moveHistory&&e.nextMove!==e.game.moveHistory.length){for(var t=e.nextMove%2===(e.game.creatorStarts?0:1)?0:1,n=e.game.moveHistory[e.nextMove].actions,a=0;a<n.length;a++){var o=n[a];"Ground"===R(o)?e.playerPos[t]=o:e.grid[o.r][o.c]=t+1}e.nextMove++}})):d((function(e){e.finishedGameWait>0?e.finishedGameWait--:(e.game=null,e.needToRequestGame=!0,e.finishedGameWait=3)})):console.log("Error: game does not have a move history"))}),2e3);return function(){return clearInterval(e)}})),Object(a.useEffect)((function(){t.on("requestedRandomGame",(function(e){var t=e.game;d((function(e){e.game=t,e.nextMove=0,e.grid=N(w.boardDims),e.playerPos=w.initialPlayerPos}))}))}),[t,d,m.needToRequestGame]),o.a.createElement(be,{creatorToMove:!1,playerColors:w.playerColors,grid:m.grid,playerPos:m.playerPos,goals:w.goals,ghostAction:null,premoveActions:[],handleClick:function(){m.game&&l(m.game._id)},groundSize:n?w.groundSize:w.smallScreenGroundSize,wallWidth:n?w.wallWidth:w.smallScreenWallWidth,isDarkModeOn:r,tokens:m.game?m.game.playerTokens:["default","default"]})},Fe={position:"sticky",top:"0px",paddingTop:"0.15rem",paddingBottom:"0.15rem",borderRadius:"0"},Ve={paddingTop:"0.15rem",paddingBottom:"0.15rem",borderRadius:"0"},qe=function(e){return Math.round(100*(e+Number.EPSILON))/100},Je=function(e){return qe(e.duration)+"+"+qe(e.increment)},Ue=function(e){return"creator"===e.winner?"<":"draw"===e.winner?"=":">"};function Ye(e,t){if(!e)return"-";var n=(new Date).getTime(),a=new Date(e).getTime(),o=Math.floor((n-a)/1e3),r=Math.floor(o/2592e3);return r>1?e.toDateString.substring(4,10):1===(r=Math.floor(o/86400))?t?"1 day ago":"1d ago":r>1?r+(t?" days":"d")+" ago":1===(r=Math.floor(o/3600))?t?"1 hour ago":"1h ago":r>1?r+(t?" hours":"h")+" ago":1===(r=Math.floor(o/60))?t?"1 minute ago":"1m ago":r>1?r+(t?" minutes":"m")+" ago":"Just now"}var Ke=function(e){var t=e.socket,n=e.isLargeScreen,r=e.isDarkModeOn,l=e.handleViewGame,c=Object(a.useState)([]),s=Object(i.a)(c,2),m=s[0],d=s[1],u=Object(a.useState)(!0),g=Object(i.a)(u,2),h=g[0],p=g[1];return Object(a.useEffect)((function(){h&&(p(!1),t.emit("getRecentGames"))}),[t,h]),Object(a.useEffect)((function(){t.on("requestedRecentGames",(function(e){var t=e.games;d(t)}))}),[t,h]),n?o.a.createElement("div",{className:"center",style:{overflowY:"scroll",display:"block",height:"100%",border:"1px solid #00796d",backgroundColor:r?"#d32f2f":"#e57373"}},o.a.createElement(f.Table,{centered:!0,style:{width:"100%"}},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"teal darken-2",style:Fe},"Time"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Player 1"),o.a.createElement("th",{className:"teal darken-2",style:Fe}),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Player 2"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Distance"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Turns"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Date"))),o.a.createElement("tbody",null,m&&m.map((function(e,t){var n="red";return n+=r?" darken-":" lighten-",n+=1+t%2,o.a.createElement("tr",{onClick:function(){return l(e._id)},style:{cursor:"pointer"},key:t,className:n},o.a.createElement("td",{style:Ve},Je(e.timeControl)),o.a.createElement("td",{style:Ve},e.playerNames[0]),o.a.createElement("td",{style:Ve},Ue(e)),o.a.createElement("td",{style:Ve},e.playerNames[1]),o.a.createElement("td",{style:Ve},function(e){for(var t=N(w.boardDims),n=O()(w.initialPlayerPos),a=e.creatorStarts?0:1,o=0;o<e.moveHistory.length;o++){for(var r=e.moveHistory[o].actions,l=0;l<r.length;l++){var c=r[l];"Ground"===R(c)?n[a]=c:t[c.r][c.c]=a+1}a=(a+1)%2}var s=Object(i.a)(w.goals,2),m=s[0],d=s[1],u=[G(t,n[0],m),G(t,n[1],d)];return u[0]+" - "+u[1]}(e)),o.a.createElement("td",{style:Ve},e.moveHistory.length),o.a.createElement("td",{style:Ve},Ye(e.startDate,!0)))}))))):o.a.createElement("div",{className:"center",style:{overflowY:"scroll",display:"block",height:"100%",border:"1px solid #00796d"}},o.a.createElement(f.Table,{centered:!0,style:{width:"100%"}},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"teal darken-2",style:Fe},"Time"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Player 1"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Win"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Player 2"),o.a.createElement("th",{className:"teal darken-2",style:Fe},"Date"))),o.a.createElement("tbody",null,m&&m.map((function(e,t){var n="red";return n+=r?" darken-":" lighten-",n+=1+t%2,o.a.createElement("tr",{onClick:function(){return l(e._id)},style:{cursor:"pointer"},key:t,className:n},o.a.createElement("td",{style:Ve},Je(e.timeControl)),o.a.createElement("td",{style:Ve},e.playerNames[0]),o.a.createElement("td",{style:Ve},Ue(e)),o.a.createElement("td",{style:Ve},e.playerNames[1]),o.a.createElement("td",{style:Ve},Ye(e.startDate,!1)))})))))},Qe=function(){return Object(g.b)({dictionaries:[g.a],length:1}).slice(0,9)},Xe=function(e){var t=e.socket,n=Object(y.a)(["playerName","token","duration","increment","cookieId","isDarkModeOn"]),r=Object(i.a)(n,2),l=r[0],c=r[1],s=Object(a.useState)(l.playerName||Qe()),m=Object(i.a)(s,2),d=m[0],u=m[1],g=Object(a.useState)(l.token||"default"),v=Object(i.a)(g,2),b=v[0],k=v[1],E=Object(a.useState)(l.duration||5),C=Object(i.a)(E,2),S=C[0],T=C[1],O=Object(a.useState)(l.increment||5),R=Object(i.a)(O,2),j=R[0],N=R[1],P=Object(a.useState)(""),D=Object(i.a)(P,2),I=D[0],G=D[1],W=Object(a.useState)(!1),L=Object(i.a)(W,2),A=L[0],M=L[1],H=Object(a.useState)(null),z=Object(i.a)(H,2),B=z[0],_=z[1],F=Object(a.useState)(!(!l.isDarkModeOn||"true"!==l.isDarkModeOn)),V=Object(i.a)(F,2),q=V[0],J=V[1],U=Object(a.useState)(!1),Y=Object(i.a)(U,2),K=Y[0],Q=Y[1],X=function(e){_({clientRole:"Spectator",gameId:e}),Q(!1),M(!0)},Z=function(){c("isDarkModeOn",q?"false":"true",{path:"/"}),J(!q)};Object(a.useEffect)((function(){l.cookieId&&"undefined"!==l.cookieId&&!K&&t.emit("checkHasOngoingGame",{cookieId:l.cookieId})})),Object(a.useEffect)((function(){t.on("respondHasOngoingGame",(function(e){var t=e.res;A||Q(t)}))})),Object(a.useEffect)((function(){var e="#004d40",t="#009688";document.body.style.backgroundColor=q?e:t}),[q]);var $,ee,te,ne=Object(h.useMediaQuery)({query:"(min-width: 990px)"}),ae=w.boardDims,oe=ne?[w.groundSize,w.wallWidth]:[w.smallScreenGroundSize,w.smallScreenWallWidth],re=Object(i.a)(oe,2),le=re[0],ie=re[1],ce=ie*(ae.h-1)/2+le*(ae.h+1)/2,se=ie*(ae.w-1)/2+le*(ae.w+1)/2,me=ne?15:6;return Object(h.useMediaQuery)({query:"(min-width: 1300px)"})?($="".concat(40,"px ").concat(ce,"px"),ee="".concat(se,"px ").concat(se,"px"),te="'showcaseTitle recentTitle' 'gameShowcase recentGameList'"):($="".concat(40,"px ").concat(ce,"px ").concat(40,"px ").concat(ce,"px"),ee="".concat(se,"px"),te="'showcaseTitle' 'gameShowcase' 'recentTitle' 'recentGameList'"),o.a.createElement("div",{style:{paddingBottom:"2rem"}},o.a.createElement(p.b,null),A&&o.a.createElement(Ae,{socket:t,clientParams:B,returnToLobby:function(){M(!1),Q(!1),_(null),G("")},isLargeScreen:ne,isDarkModeOn:q,handleToggleDarkMode:Z,handleSetCookieId:function(e){c("cookieId",e,{path:"/"})}}),!A&&o.a.createElement("div",null,o.a.createElement(Ce,{context:"Lobby",helpText:ze,aboutText:Be,isLargeScreen:ne,isDarkModeOn:q,handleToggleDarkMode:Z}),o.a.createElement(He,{playerName:d,handlePlayerName:function(e){u(e.target.value.slice(0,9))},duration:S,handleDuration:function(e){return T(e.target.value)},increment:j,handleIncrement:function(e){return N(e.target.value)},joinCode:I,handleJoinCode:function(e){return G(e.target.value)},handleCreateGame:function(){var e=[parseFloat(S),parseFloat(j)],t=e[0],n=e[1];isNaN(t)||t<.1?(t=5/60,x("Invalid duration, using 5s instead",5e3)):t>120?(t=120,x("Duration too long, using 2h instead",5e3)):c("duration",t,{path:"/"}),isNaN(n)||n<0?(n=0,x("Invalid increment, using 0s instead",5e3)):n>300?(n=300,x("Increment too large, using 5m instead",5e3)):c("increment",n,{path:"/"});var a=d;""===a?a="Anon":c("playerName",a,{path:"/"}),_({clientRole:"Creator",timeControl:{duration:t,increment:n},name:a,token:b,cookieId:l.cookieId?l.cookieId:"undefined"}),Q(!1),M(!0)},handleJoinGame:function(){var e=d;""===e?e="Anon":c("playerName",e,{path:"/"}),_({clientRole:"Joiner",joinCode:I,name:e,token:b,cookieId:l.cookieId?l.cookieId:"undefined"}),Q(!1),M(!0)},handleRefreshName:function(){u(Qe())},token:b,handleToken:function(e){k(e),c("token",e,{path:"/"})},isLargeScreen:ne}),K&&l.cookieId&&"undefined"!==l.cookieId&&o.a.createElement(f.Row,{className:"valign-wrapper",style:{marginTop:"1rem"}},o.a.createElement(f.Col,{className:"center",s:12},o.a.createElement(f.Button,{large:!0,className:"red",node:"button",waves:"light",onClick:function(){_({clientRole:"Returner",cookieId:l.cookieId}),Q(!1),M(!0)}},"Return to game"))),o.a.createElement("div",{style:{display:"grid",gridTemplateRows:$,gridTemplateColumns:ee,gridTemplateAreas:te,columnGap:"".concat(2*me,"px"),rowGap:"".concat(me,"px"),margin:"".concat(me,"px"),justifyContent:"center",alignContent:"center"}},o.a.createElement("div",{style:{gridArea:"showcaseTitle",alignSelf:"center",justifySelf:"center",fontSize:"20px"},title:"Random games already played"},"Game Showcase"),o.a.createElement("div",{style:{gridArea:"gameShowcase"}},o.a.createElement(_e,{socket:t,isLargeScreen:ne,isDarkModeOn:q,handleViewGame:X})),o.a.createElement("div",{style:{gridArea:"recentTitle",alignSelf:"center",justifySelf:"center",fontSize:"20px"}},"Recent games"),o.a.createElement("div",{style:{gridArea:"recentGameList"}},o.a.createElement(Ke,{socket:t,isLargeScreen:ne,isDarkModeOn:q,handleViewGame:X})))))},Ze=function(){console.log("connecting to backend at ".concat("https://wallwars.herokuapp.com/"));var e=Object(a.useState)(d()("https://wallwars.herokuapp.com/")),t=Object(i.a)(e,1)[0];return o.a.createElement(o.a.StrictMode,null,o.a.createElement(u.a,null,o.a.createElement(c.a,null,o.a.createElement(s.d,null,o.a.createElement(s.b,{path:"/wallwars/index.html",exact:!0},o.a.createElement(Xe,{socket:t})),o.a.createElement(s.a,{to:"/wallwars/index.html"})))))};l.a.render(o.a.createElement(Ze,null),document.getElementById("root"))},30:function(e,t,n){e.exports=n.p+"static/media/moveSound.6df49e4b.mp3"},75:function(e,t,n){e.exports=n(165)},80:function(e,t,n){}},[[75,1,2]]]);
//# sourceMappingURL=main.8a8266ba.chunk.js.map